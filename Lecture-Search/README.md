# 复旦大学讲座信息抓取工具

## 功能介绍

本工具用于从互联网公开平台及微信平台定向抓取【复旦大学】的【讲座信息】，确保抓取的信息包含讲座的时间、地点及主题，并尽可能保证信息的完整性与全面性。

### 主要特点

- 支持从复旦大学官方网站抓取讲座信息
- 支持从复旦大学各学院网站抓取讲座信息
- 支持从微信平台抓取讲座信息（需配置API）
- 自动去重并保存为Excel文件
- 具有随机休眠功能，避免被反爬

## 环境要求

- Python 3.7+ 
- pip

## 安装依赖

首先安装所需的Python依赖包：

```bash
pip install -r requirements.txt
```

## 使用方法

1. 确保已安装所有依赖包
2. （可选）如果需要从微信平台抓取信息，请配置微信API接口
3. 运行主程序：

```bash
python lecture_scraper.py
```

## 微信平台API配置

由于微信平台内容搜索需要调用API接口，本程序提供了相应的接口框架，但需要用户手动补全API信息：

1. 复制.env.example文件为.env：

```bash
cp .env.example .env
```

2. 编辑.env文件，填写微信公众平台的API凭证：

```
WECHAT_APPID=your_wechat_appid_here
WECHAT_SECRET=your_wechat_secret_here
```

3. 注意：微信官方API并不直接提供搜索功能，程序中的微信抓取部分目前使用模拟数据。实际应用中，您可能需要：
   - 使用第三方微信公众号文章搜索API
   - 自行开发爬虫抓取微信公众号文章
   - 或接入微信开放平台的相关接口

## 代码结构说明

主要功能模块：

1. `FudanLectureScraper` 类 - 主类，包含所有抓取逻辑
2. `scrape_fudan_official()` - 从复旦大学官方网站抓取讲座信息
3. `scrape_school_websites()` - 从复旦大学各学院网站抓取讲座信息
4. `scrape_wechat_platform()` - 从微信平台抓取讲座信息（需配置API）
5. `save_to_excel()` - 将抓取的信息保存到Excel文件

## 输出结果

程序运行后，会在当前目录生成一个Excel文件，文件名格式为：`fudan_lectures_YYYYMMDD.xlsx`，包含以下字段：

- 标题（title）
- 日期（date）
- 地点（location）
- 来源（source）
- 链接（link）

## 注意事项

1. 网页结构可能会变化，导致抓取失败。如遇到这种情况，请更新相应的选择器。
2. 频繁抓取可能会触发网站的反爬机制。程序已内置随机休眠功能，但仍建议不要过于频繁地运行。
3. 微信平台的API调用需要符合微信官方的规范和限制。

## 免责声明

本工具仅用于学习和研究目的，请确保您的使用符合相关法律法规。对于使用本工具可能产生的任何后果，开发者不承担责任。